-- detailes: columns
SELECT TABLE_CATALOG as DatabaseName,	TABLE_SCHEMA,	TABLE_NAME,	COLUMN_NAME,	ORDINAL_POSITION,	COLUMN_DEFAULT,	IS_NULLABLE,	DATA_TYPE,	CHARACTER_MAXIMUM_LENGTH,	CHARACTER_OCTET_LENGTH
FROM INFORMATION_SCHEMA.COLUMNS c1
WHERE c1.DATA_TYPE IN ('text', 'ntext', 'image', 'varbinary', 'binary', 'xml') 
or (c1.DATA_TYPE IN ('nvarchar', 'varchar') and c1.CHARACTER_MAXIMUM_LENGTH = -1)



select a1.TABLE_CATALOG as DatabaseName, a1.Total_Number_of_Tables, 
im1.Tables_with_IMAGE, vm1.Tables_with_VARBINARY_MAX, vb1.Tables_with_VARBINARY,bn1.Tables_with_BINARY,
tx1.Tables_with_TEXT, nt1.Tables_with_NTEXT,  nv1.Tables_with_NVARCHAR_MAX,  vc1.Tables_with_VARCHAR_MAX,
xm1.Tables_with_XML
from 
(select t1.TABLE_CATALOG, count(t1.TABLE_NAME) as Total_Number_of_Tables
from INFORMATION_SCHEMA.TABLES t1
group by t1.TABLE_CATALOG) a1
left outer join
(select COUNT(t1.TABLE_NAME) as Tables_with_IMAGE
from INFORMATION_SCHEMA.TABLES t1
where exists 
(SELECT 1
FROM INFORMATION_SCHEMA.COLUMNS c1
WHERE c1.DATA_TYPE IN ('image') 
and t1.TABLE_CATALOG = c1.TABLE_CATALOG
and t1.TABLE_SCHEMA = c1.TABLE_SCHEMA
and t1.TABLE_NAME = c1.TABLE_NAME)) im1
on 1 = 1
left outer join
(select COUNT(t1.TABLE_NAME) as Tables_with_VARBINARY_MAX
from INFORMATION_SCHEMA.TABLES t1
where exists 
(SELECT 1
FROM INFORMATION_SCHEMA.COLUMNS c1
WHERE c1.DATA_TYPE IN ('varbinary')
and c1.CHARACTER_MAXIMUM_LENGTH = -1 
and t1.TABLE_CATALOG = c1.TABLE_CATALOG
and t1.TABLE_SCHEMA = c1.TABLE_SCHEMA
and t1.TABLE_NAME = c1.TABLE_NAME)) vm1
on 1 = 1
left outer join
(select COUNT(t1.TABLE_NAME) as Tables_with_VARBINARY
from INFORMATION_SCHEMA.TABLES t1
where exists 
(SELECT 1
FROM INFORMATION_SCHEMA.COLUMNS c1
WHERE c1.DATA_TYPE IN ('varbinary')
and t1.TABLE_CATALOG = c1.TABLE_CATALOG
and t1.TABLE_SCHEMA = c1.TABLE_SCHEMA
and t1.TABLE_NAME = c1.TABLE_NAME)) vb1
on 1 = 1
left outer join
(select COUNT(t1.TABLE_NAME) as Tables_with_BINARY
from INFORMATION_SCHEMA.TABLES t1
where exists 
(SELECT 1
FROM INFORMATION_SCHEMA.COLUMNS c1
WHERE c1.DATA_TYPE IN ('binary') 
and t1.TABLE_CATALOG = c1.TABLE_CATALOG
and t1.TABLE_SCHEMA = c1.TABLE_SCHEMA
and t1.TABLE_NAME = c1.TABLE_NAME)) bn1
on 1 = 1
left outer join
(select COUNT(t1.TABLE_NAME) as Tables_with_TEXT
from INFORMATION_SCHEMA.TABLES t1
where exists 
(SELECT 1
FROM INFORMATION_SCHEMA.COLUMNS c1
WHERE c1.DATA_TYPE IN ('text') 
and t1.TABLE_CATALOG = c1.TABLE_CATALOG
and t1.TABLE_SCHEMA = c1.TABLE_SCHEMA
and t1.TABLE_NAME = c1.TABLE_NAME)) tx1
on 1 = 1
left outer join
(select COUNT(t1.TABLE_NAME) as Tables_with_NTEXT
from INFORMATION_SCHEMA.TABLES t1
where exists 
(SELECT 1
FROM INFORMATION_SCHEMA.COLUMNS c1
WHERE c1.DATA_TYPE IN ('ntext') 
and t1.TABLE_CATALOG = c1.TABLE_CATALOG
and t1.TABLE_SCHEMA = c1.TABLE_SCHEMA
and t1.TABLE_NAME = c1.TABLE_NAME)) nt1
on 1 = 1
left outer join
(select COUNT(t1.TABLE_NAME) as Tables_with_NVARCHAR_MAX
from INFORMATION_SCHEMA.TABLES t1
where exists 
(SELECT 1
FROM INFORMATION_SCHEMA.COLUMNS c1
WHERE c1.DATA_TYPE IN ('nvarchar') 
and c1.CHARACTER_MAXIMUM_LENGTH = -1
and t1.TABLE_CATALOG = c1.TABLE_CATALOG
and t1.TABLE_SCHEMA = c1.TABLE_SCHEMA
and t1.TABLE_NAME = c1.TABLE_NAME)) nv1
on 1 = 1
left outer join
(select COUNT(t1.TABLE_NAME) as Tables_with_VARCHAR_MAX
from INFORMATION_SCHEMA.TABLES t1
where exists 
(SELECT 1
FROM INFORMATION_SCHEMA.COLUMNS c1
WHERE c1.DATA_TYPE IN ('varchar')
and c1.CHARACTER_MAXIMUM_LENGTH = -1 
and t1.TABLE_CATALOG = c1.TABLE_CATALOG
and t1.TABLE_SCHEMA = c1.TABLE_SCHEMA
and t1.TABLE_NAME = c1.TABLE_NAME)) vc1
on 1 = 1
left outer join
(select COUNT(t1.TABLE_NAME) as Tables_with_XML
from INFORMATION_SCHEMA.TABLES t1
where exists 
(SELECT 1
FROM INFORMATION_SCHEMA.COLUMNS c1
WHERE c1.DATA_TYPE IN ('xml') 
and t1.TABLE_CATALOG = c1.TABLE_CATALOG
and t1.TABLE_SCHEMA = c1.TABLE_SCHEMA
and t1.TABLE_NAME = c1.TABLE_NAME)) xm1
on 1 = 1



